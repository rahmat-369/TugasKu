<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>TugasKu - Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="assets/my-icon.png">
    <link rel="stylesheet" href="assets/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>TugasKu</h1>
            <div class="header-actions">
                <button class="btn btn-outline" onclick="toggleSettingsMenu()">‚ò∞</button>
            </div>
        </header>

        <!-- Tab Navigation -->
        <nav class="tab-nav">
            <button class="tab-btn active" data-tab="tasks" onclick="switchTab('tasks')">Tugas <span class="badge" id="taskBadge"></span></button>
            <button class="tab-btn" data-tab="schedules" onclick="switchTab('schedules')">Jadwal</button>
            <button class="tab-btn" data-tab="notes" onclick="switchTab('notes')">Catatan</button>
        </nav>

        <!-- Tab Content -->
        <div class="tab-content active" id="tasksTab">
            <div class="controls">
                <button class="btn btn-primary" onclick="toggleForm(true)">+ Tambah Tugas</button>
            </div>
            <form class="card" id="taskForm" style="display: none;">
                <div class="input-group">
                    <label for="taskSubject">Mata Pelajaran</label>
                    <input type="text" id="taskSubject" placeholder="Matematika, Fisika, dll">
                </div>
                <div class="input-group">
                    <label for="taskName">Nama Tugas</label>
                    <input type="text" id="taskName" placeholder="Contoh: Halaman 20, PR Bab 3">
                </div>
                <div class="input-group">
                    <label for="taskDeadline">Deadline</label>
                    <input type="date" id="taskDeadline">
                </div>
                <div class="input-group">
                    <label for="taskNotes">Catatan (opsional)</label>
                    <textarea id="taskNotes" placeholder="Barang yang harus dibawa, dll."></textarea>
                </div>
                 <div class="input-group">
                    <label for="taskPriority">Prioritas</label>
                    <select id="taskPriority">
                        <option value="low">Rendah</option>
                        <option value="medium" selected>Sedang</option>
                        <option value="high">Tinggi</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Simpan Tugas</button>
                <button type="button" class="btn btn-outline" onclick="toggleForm(false)">Batal</button>
            </form>
            <div id="taskList"></div>
        </div>

        <div class="tab-content" id="schedulesTab">
            <div class="controls">
                <button class="btn btn-primary" onclick="toggleScheduleForm(true)">+ Tambah Jadwal</button>
            </div>
            <form class="card" id="scheduleForm" style="display: none;">
                <div class="input-group">
                    <label for="scheduleSubject">Mata Pelajaran</label>
                    <input type="text" id="scheduleSubject" placeholder="Matematika, Fisika, dll">
                </div>
                <div class="input-group">
                    <label for="scheduleDay">Hari</label>
                    <select id="scheduleDay">
                        <option value="senin">Senin</option>
                        <option value="selasa">Selasa</option>
                        <option value="rabu">Rabu</option>
                        <option value="kamis">Kamis</option>
                        <option value="jumat">Jumat</option>
                        <option value="sabtu">Sabtu</option>
                        <option value="minggu">Minggu</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="scheduleTime">Jam (HH:MM - HH:MM)</label>
                    <input type="text" id="scheduleTime" placeholder="08:00 - 09:30">
                </div>
                <div class="input-group">
                    <label for="scheduleTeacher">Nama Guru (opsional)</label>
                    <input type="text" id="scheduleTeacher" placeholder="Pak Ahmad">
                </div>
                <div class="input-group">
                    <label for="scheduleNotes">Catatan (opsional)</label>
                    <textarea id="scheduleNotes" placeholder="Bawa alat ukur"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Simpan Jadwal</button>
                <button type="button" class="btn btn-outline" onclick="toggleScheduleForm(false)">Batal</button>
            </form>
            <div id="scheduleList"></div>
        </div>

        <div class="tab-content" id="notesTab">
            <div class="controls">
                <button class="btn btn-primary" onclick="toggleNoteForm(true)">+ Tambah Catatan</button>
            </div>
            <form class="card" id="noteForm" style="display: none;">
                <div class="input-group">
                    <label for="noteTitle">Judul</label>
                    <input type="text" id="noteTitle" placeholder="Ide Projek, Link Penting">
                </div>
                <div class="input-group">
                    <label for="noteContent">Isi Catatan</label>
                    <textarea id="noteContent" rows="4" placeholder="Detail catatan..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Simpan Catatan</button>
                <button type="button" class="btn btn-outline" onclick="toggleNoteForm(false)">Batal</button>
            </form>
            <div id="notesList"></div>
        </div>

    </div>

    <!-- Floating Action Button -->
    <button class="fab" id="fab" onclick="openCurrentForm()">+</button>

    <!-- Settings Menu -->
    <div class="modal-overlay" id="settingsMenu">
        <div class="modal">
            <div class="modal-header">
                <h2>Pengaturan</h2>
                <button class="modal-close" onclick="closeSettingsMenu()">&times;</button>
            </div>
            <div class="settings-options">
                <button class="btn btn-outline" onclick="handleSettingsAction('about')">Tentang Aplikasi</button>
                <button class="btn btn-outline" onclick="handleSettingsAction('theme')">Ganti Tema</button>
                <button class="btn btn-danger" onclick="handleSettingsAction('reset')">Reset Data</button>
            </div>
        </div>
    </div>

    <!-- Theme Selection Modal -->
    <div class="modal-overlay" id="themeModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Pilih Tema</h2>
                <button class="modal-close" onclick="closeThemeModal()">&times;</button>
            </div>
            <div class="theme-options">
                <button class="btn btn-outline" onclick="setTheme('light')">Light</button>
                <button class="btn btn-outline" onclick="setTheme('dark')">Dark</button>
                <button class="btn btn-outline" onclick="setTheme('colorful')">Colorful</button>
                <button class="btn btn-outline" onclick="setTheme('forest')">Forest</button>
                <button class="btn btn-outline" onclick="setTheme('ocean')">Ocean</button>
                <button class="btn btn-outline" onclick="setTheme('sakura')">Sakura</button>
            </div>
        </div>
    </div>

    <!-- Stats Modal -->
    <div class="modal-overlay" id="statsModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <h2>Statistik Tugas</h2>
                <button class="modal-close" onclick="closeStatsModalFunc()">&times;</button>
            </div>
            <div class="stats-content">
                <div class="chart-container">
                    <canvas id="statusChart"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="priorityChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- About Modal -->
    <div class="modal-overlay" id="aboutModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Tentang TugasKu</h2>
                <button class="modal-close" onclick="closeAboutModal()">&times;</button>
            </div>
            <div class="about-content">
                <h3>Aplikasi Pengelola Tugas dan Jadwal</h3>
                <p>TugasKu membantu kamu mengatur tugas sekolah dan jadwal pelajaran dengan mudah.</p>
                <h3>Fitur Utama</h3>
                <ul class="feature-list">
                    <li>üìù Tambah dan kelola tugas harian</li>
                    <li>üìÖ Jadwal pelajaran mingguan</li>
                    <li>üìù Catatan pribadi</li>
                    <li>üè∑Ô∏è Filter tugas berdasarkan status dan deadline</li>
                    <li>üé® Pilihan tema yang beragam</li>
                    <li>üíæ Data tersimpan di browser (localStorage)</li>
                    <li>üì± Responsif untuk mobile dan desktop</li>
                    <li>ü§ñ AI Assistant untuk input otomatis</li>
                </ul>
                <h3 style="margin-top: 16px;">Versi: 1.3.0</h3>
                <p style="margin-top: 8px;">Tanggal dibuat: 30 Agustus 2025</p>
                <p style="margin-top: 8px;">Pengembang: Rahmat, pelajar MA kelas 11</p>
                <p style="margin-top: 24px;">Pesan dari developer: Aplikasi ini sepenuhnya dikembangkan dan diuji pada perangkat dengan spesifikasi rendah ("Oppo A3s"), jadi mohon dimaklumi jika masih ada kekurangan. Tidak akan ada update lagi. Terima kasih telah menggunakan TugasKu. Jika ada bug fatal, hubungi saya di email yang tercantum.</p>
            </div>
            <div class="version-info">
                <p>¬© 2025 TugasKu. Hak Cipta Dilindungi.</p>
            </div>
        </div>
    </div>

    <!-- Tips Modal -->
    <div class="modal-overlay" id="tipsModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Tip & Trik</h2>
                <button class="modal-close" onclick="closeTipsModalFunc()">&times;</button>
            </div>
            <div class="tips-content">
                <!-- Tips content would go here -->
                <p>Gunakan AI Assistant untuk menambahkan tugas secara otomatis dari pesan alami.</p>
                <p>Gunakan filter untuk mencari tugas yang terlambat.</p>
                <p>Ganti tema untuk kenyamanan membaca.</p>
            </div>
        </div>
    </div>

    <!-- Preview Modal (from AI logic) -->
    <div class="modal-overlay" id="previewModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Pratinjau & Edit</h2>
                <button class="modal-close" onclick="closeModal(document.getElementById('previewModal'))">&times;</button>
            </div>
            <div id="previewModalContent">
                <!-- Content filled by JS -->
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="assets/app.js" defer></script>

    <script>
        // ===== STATE & ELEMENT REFERENCES =====
        let tasks = [];
        let schedules = [];
        let notes = [];
        let currentFilter = 'all';
        let searchQuery = '';
        let currentTab = 'tasks';
        let currentTheme = localStorage.getItem('theme') || 'light';

        const taskForm = document.getElementById('taskForm');
        const scheduleForm = document.getElementById('scheduleForm');
        const noteForm = document.getElementById('noteForm');
        const fab = document.getElementById('fab');

        // ===== INITIALISATION =====
        function init() {
            // Load data from storage
            tasks = StorageManager.get(StorageManager.STORAGE_KEYS.TASKS);
            schedules = StorageManager.get(StorageManager.STORAGE_KEYS.SCHEDULES);
            notes = StorageManager.get(StorageManager.STORAGE_KEYS.NOTES);

            // Apply theme
            initTheme();

            // Set minimum date for deadline input
            setMinDeadline();

            // Bind event listeners
            initEventListeners();

            // Show initial tab
            switchTab('tasks');

            showToast('Aplikasi siap digunakan', 2000);
        }

        // ===== THEME LOGIC =====
        function initTheme() {
            document.body.className = currentTheme + '-mode';
        }

        function setTheme(theme) {
            currentTheme = theme;
            localStorage.setItem('theme', theme);
            initTheme();
            closeThemeModal();
        }

        function closeThemeModal() {
            document.getElementById('themeModal').classList.remove('show');
        }

        // ===== FORM LOGIC =====
        function toggleForm(show) {
            taskForm.style.display = show ? 'block' : 'none';
            if (!show) taskForm.reset();
        }

        function toggleScheduleForm(show) {
            scheduleForm.style.display = show ? 'block' : 'none';
            if (!show) scheduleForm.reset();
        }

        function toggleNoteForm(show) {
            noteForm.style.display = show ? 'block' : 'none';
            if (!show) noteForm.reset();
        }

        function openCurrentForm() {
            if (currentTab === 'tasks') toggleForm(true);
            else if (currentTab === 'schedules') toggleScheduleForm(true);
            else if (currentTab === 'notes') toggleNoteForm(true);
        }

        // ===== TAB LOGIC =====
        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                if (btn.dataset.tab === tabName) btn.classList.add('active');
                else btn.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                if (content.id === `${tabName}Tab`) content.classList.add('active');
                else content.classList.remove('active');
            });
            currentTab = tabName;
            fab.style.display = 'flex';
        }

        // ===== EVENT LISTENERS =====
        function initEventListeners() {
            taskForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const subject = document.getElementById('taskSubject').value.trim();
                const name = document.getElementById('taskName').value.trim();
                const deadline = document.getElementById('taskDeadline').value;
                const notes = document.getElementById('taskNotes').value.trim();
                const priority = document.getElementById('taskPriority').value;

                if (!subject || !name || !deadline) {
                    showToast('Harap isi semua field yang diperlukan');
                    return;
                }

                const newTask = {
                    id: generateId(),
                    title: `${name} - ${subject}`,
                    subject,
                    name,
                    deadline,
                    notes,
                    priority,
                    status: 'new',
                    createdAt: Date.now()
                };

                tasks.push(newTask);
                saveTasks();
                renderTasks();
                toggleForm(false);
                showToast('Tugas ditambahkan');
            });

            scheduleForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const subject = document.getElementById('scheduleSubject').value.trim();
                const day = document.getElementById('scheduleDay').value;
                const time = document.getElementById('scheduleTime').value.trim();
                const teacher = document.getElementById('scheduleTeacher').value.trim();
                const notes = document.getElementById('scheduleNotes').value.trim();

                if (!subject || !day || !time) {
                    showToast('Harap isi semua field yang diperlukan');
                    return;
                }

                const newSchedule = {
                    id: generateId(),
                    subject,
                    day,
                    time,
                    teacher,
                    notes,
                    createdAt: Date.now()
                };

                schedules.push(newSchedule);
                saveSchedules();
                renderSchedules();
                toggleScheduleForm(false);
                showToast('Jadwal ditambahkan');
            });

            noteForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const title = document.getElementById('noteTitle').value.trim();
                const content = document.getElementById('noteContent').value.trim();

                if (!title || !content) {
                    showToast('Harap isi semua field yang diperlukan');
                    return;
                }

                const newNote = {
                    id: generateId(),
                    title,
                    content,
                    createdAt: Date.now(),
                    updatedAt: Date.now()
                };

                notes.push(newNote);
                saveNotes();
                renderNotes();
                toggleNoteForm(false);
                showToast('Catatan ditambahkan');
            });
        }

        // ===== RENDERING FUNCTIONS =====
        function renderTasks() {
            const taskList = document.getElementById('taskList');
            if (!taskList) return;

            const filteredTasks = tasks.filter(task => {
                const matchesFilter = currentFilter === 'all' ||
                                     (currentFilter === 'active' && task.status !== 'done') ||
                                     (currentFilter === 'done' && task.status === 'done');
                const matchesSearch = task.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
                                      task.subject.toLowerCase().includes(searchQuery.toLowerCase());
                return matchesFilter && matchesSearch;
            }).sort((a, b) => {
                const priorityOrder = { high: 0, medium: 1, low: 2 };
                if ((priorityOrder[a.priority] || 2) !== (priorityOrder[b.priority] || 2)) {
                    return (priorityOrder[a.priority] || 2) - (priorityOrder[b.priority] || 2);
                }
                return new Date(a.deadline) - new Date(b.deadline);
            });

            if (filteredTasks.length === 0) {
                taskList.innerHTML = `<div class="empty-state"><div style="font-size:48px;margin-bottom:16px;">üìã</div><h3>Tidak ada tugas</h3><p>Tambahkan tugas baru untuk memulai</p></div>`;
                updateBadge();
                return;
            }

            taskList.innerHTML = filteredTasks.map(task => {
                let statusText = '';
                let statusColor = '';
                switch (task.status) {
                    case 'done':
                        statusText = 'Selesai';
                        statusColor = 'status-done';
                        break;
                    case 'overdue':
                        statusText = 'Terlambat';
                        statusColor = 'status-overdue';
                        break;
                    default:
                        statusText = 'Baru';
                        statusColor = 'status-new';
                }
                return `
                <div class="task-item">
                    <div class="task-header">
                        <div class="task-title">${task.title}</div>
                        <div class="task-subject">${task.subject}</div>
                    </div>
                    <div class="task-details">
                        <div>Nama: ${task.name || 'N/A'}</div>
                        <div>Deadline: ${task.deadline}</div>
                        <div>Catatan: ${task.notes || 'N/A'}</div>
                    </div>
                    <div class="task-status ${statusColor}">${statusText}</div>
                    <div class="task-actions">
                        <button class="filter-btn" onclick="handleTaskAction('${task.id}', 'toggle')">${task.status === 'done' ? '‚Ü©Ô∏è Batal' : '‚úÖ Selesai'}</button>
                        <button class="filter-btn" onclick="handleTaskAction('${task.id}', 'edit')">‚úèÔ∏è Edit</button>
                        <button class="filter-btn" onclick="handleTaskAction('${task.id}', 'delete')">üóëÔ∏è Hapus</button>
                    </div>
                </div>`;
            }).join('');

            updateBadge();
        }

        function renderSchedules() {
            const scheduleList = document.getElementById('scheduleList');
            if (!scheduleList) return;

            if (schedules.length === 0) {
                scheduleList.innerHTML = `<div class="empty-state"><div style="font-size:48px;margin-bottom:16px;">üìÖ</div><h3>Belum ada jadwal</h3><p>Tambahkan jadwal pelajaran</p></div>`;
                return;
            }

            scheduleList.innerHTML = schedules.map(schedule => `
                <div class="schedule-item">
                    <div class="schedule-day">${schedule.day.charAt(0).toUpperCase() + schedule.day.slice(1)}</div>
                    <div class="schedule-time">${schedule.time}</div>
                    <div class="schedule-subject">${schedule.subject}</div>
                    <div class="schedule-teacher">${schedule.teacher ? `Guru: ${schedule.teacher}` : ''}</div>
                    <div class="schedule-notes">${schedule.notes || ''}</div>
                    <div class="schedule-actions">
                        <button class="filter-btn" onclick="handleScheduleAction('${schedule.id}', 'edit')">‚úèÔ∏è Edit</button>
                        <button class="filter-btn" onclick="handleScheduleAction('${schedule.id}', 'delete')">üóëÔ∏è Hapus</button>
                    </div>
                </div>`
            ).join('');
        }

        function renderNotes() {
            const notesList = document.getElementById('notesList');
            if (!notesList) return;

            if (notes.length === 0) {
                notesList.innerHTML = `<div class="empty-state"><div style="font-size:48px;margin-bottom:16px;">üìù</div><h3>Belum ada catatan</h3><p>Tambahkan catatan baru untuk memulai</p></div>`;
                return;
            }

            notes.sort((a, b) => b.updatedAt - a.updatedAt);

            notesList.innerHTML = notes.map(note => `
                <div class="note-card">
                    <div class="note-title">${note.title}</div>
                    <div class="note-content">${note.content}</div>
                    <div class="note-meta">
                        Dibuat: ${formatTimestamp(note.createdAt)}<br>
                        Diupdate: ${formatTimestamp(note.updatedAt)}
                    </div>
                    <div class="note-actions">
                        <button class="filter-btn" onclick="handleNoteAction('${note.id}', 'edit')">‚úèÔ∏è Edit</button>
                        <button class="filter-btn" onclick="handleNoteAction('${note.id}', 'delete')">üóëÔ∏è Hapus</button>
                    </div>
                </div>`
            ).join('');
        }

        // ===== ACTION HANDLERS =====
        function handleTaskAction(taskId, action) {
            const taskIndex = tasks.findIndex(t => t.id == taskId);
            if (taskIndex === -1) return;
            const task = tasks[taskIndex];

            switch(action) {
                case 'toggle':
                    task.status = task.status === 'done' ? 'new' : 'done';
                    saveTasks();
                    renderTasks();
                    showToast(task.status === 'done' ? 'Tugas selesai!' : 'Tugas dibatalkan');
                    break;
                case 'edit':
                    document.getElementById('taskSubject').value = task.subject;
                    document.getElementById('taskName').value = task.name;
                    document.getElementById('taskDeadline').value = task.deadline;
                    document.getElementById('taskNotes').value = task.notes || '';
                    document.getElementById('taskPriority').value = task.priority || 'medium';
                    tasks.splice(taskIndex, 1);
                    saveTasks();
                    renderTasks();
                    toggleForm(true);
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                    showToast('Edit tugas');
                    break;
                case 'delete':
                    if (confirm('Apakah Anda yakin ingin menghapus tugas ini?')) {
                        tasks.splice(taskIndex, 1);
                        saveTasks();
                        renderTasks();
                        updateBadge();
                        showToast('Tugas dihapus');
                    }
                    break;
            }
        }

        function handleScheduleAction(scheduleId, action) {
            const scheduleIndex = schedules.findIndex(s => s.id == scheduleId);
            if (scheduleIndex === -1) return;
            const schedule = schedules[scheduleIndex];

            switch(action) {
                case 'edit':
                    document.getElementById('scheduleSubject').value = schedule.subject;
                    document.getElementById('scheduleDay').value = schedule.day;
                    document.getElementById('scheduleTime').value = schedule.time;
                    document.getElementById('scheduleTeacher').value = schedule.teacher || '';
                    document.getElementById('scheduleNotes').value = schedule.notes || '';
                    schedules.splice(scheduleIndex, 1);
                    saveSchedules();
                    renderSchedules();
                    toggleScheduleForm(true);
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                    showToast('Edit jadwal');
                    break;
                case 'delete':
                    if (confirm('Apakah Anda yakin ingin menghapus jadwal ini?')) {
                        schedules.splice(scheduleIndex, 1);
                        saveSchedules();
                        renderSchedules();
                        showToast('Jadwal dihapus');
                    }
                    break;
            }
        }

        function handleNoteAction(noteId, action) {
            const noteIndex = notes.findIndex(n => n.id == noteId);
            if (noteIndex === -1) return;
            const note = notes[noteIndex];

            switch(action) {
                case 'edit':
                    document.getElementById('noteTitle').value = note.title;
                    document.getElementById('noteContent').value = note.content;
                    notes.splice(noteIndex, 1);
                    saveNotes();
                    renderNotes();
                    toggleNoteForm(true);
                    document.getElementById('noteTitle').scrollIntoView({ behavior: 'smooth' });
                    showToast('Edit catatan');
                    break;
                case 'delete':
                    if (confirm('Apakah Anda yakin ingin menghapus catatan ini?')) {
                        notes.splice(noteIndex, 1);
                        saveNotes();
                        renderNotes();
                        showToast('Catatan dihapus');
                    }
                    break;
            }
        }

        // ===== UTILITY FUNCTIONS =====
        function saveTasks() { StorageManager.set(StorageManager.STORAGE_KEYS.TASKS, tasks); }
        function saveSchedules() { StorageManager.set(StorageManager.STORAGE_KEYS.SCHEDULES, schedules); }
        function saveNotes() { StorageManager.set(StorageManager.STORAGE_KEYS.NOTES, notes); }

        function updateBadge() {
            const activeTasks = tasks.filter(task => task.status !== 'done').length;
            const badge = document.getElementById('taskBadge');
            if (badge) {
                badge.textContent = activeTasks > 0 ? activeTasks : '';
                badge.style.display = activeTasks > 0 ? 'inline' : 'none';
            }
        }

        function setMinDeadline() {
            const today = new Date().toISOString().split('T')[0];
            const deadlineInput = document.getElementById('taskDeadline');
            if (deadlineInput) deadlineInput.min = today;
        }

        function formatTimestamp(timestamp) {
            return new Date(timestamp).toLocaleDateString('id-ID', {
                day: 'numeric', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit'
            });
        }

        // ===== MODAL CONTROLS =====
        function toggleSettingsMenu() {
            document.getElementById('settingsMenu').classList.toggle('show');
        }
        function closeSettingsMenu() {
            document.getElementById('settingsMenu').classList.remove('show');
        }
        function handleSettingsAction(action) {
            switch(action) {
                case 'about':
                    document.getElementById('aboutModal').classList.add('show');
                    closeSettingsMenu();
                    break;
                case 'theme':
                    document.getElementById('themeModal').classList.add('show');
                    closeSettingsMenu();
                    break;
                case 'reset':
                    if (confirm('Apakah Anda yakin ingin mereset semua data?')) {
                        StorageManager.clearAll();
                        tasks = [];
                        schedules = [];
                        notes = [];
                        renderTasks();
                        renderSchedules();
                        renderNotes();
                        updateBadge();
                        showToast('Data telah direset');
                    }
                    closeSettingsMenu();
                    break;
            }
        }

        function showStatsModal() {
            document.getElementById('statsModal').classList.add('show');
            // Initialize charts here if needed
        }
        function closeStatsModalFunc() {
            document.getElementById('statsModal').classList.remove('show');
        }
        function showTipsModal() {
            document.getElementById('tipsModal').classList.add('show');
        }
        function closeTipsModalFunc() {
            document.getElementById('tipsModal').classList.remove('show');
        }
        function closeAboutModal() {
            document.getElementById('aboutModal').classList.remove('show');
        }

        // ===== INITIALIZE APP =====
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>